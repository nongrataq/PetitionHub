<#import "../patterns/layout.ftlh" as layout>
<@layout.main title="Search"
styles='<link rel="stylesheet" href="/css/petitions/search-style.css">'>

    <div class="container mt-5">

        <div class="d-flex justify-content-center mb-4">
            <div style="width: 100%; max-width: 720px;">

                <!-- –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ -->
                <div id="searchInputWrapper" class="d-flex align-items-stretch" style="gap: 0.5rem;">
                    <input type="text"
                           id="searchInput"
                           class="form-control form-control-lg input-gradient-border flex-grow-1"
                           placeholder="–ù–∞–π–¥–∏—Ç–µ –ø–µ—Ç–∏—Ü–∏—é –ø–æ —Ç–µ–º–µ...">
                    <button id="searchBtn"
                            class="btn btn-primary btn-lg d-flex align-items-center px-4"
                            style="font-size: 1.25rem; font-weight: 500;"
                            type="button">
                        <i class="bi bi-search me-2"></i> –ù–∞–π—Ç–∏
                    </button>
                    <ul class="autocomplete-list list-group" id="autocompleteList"></ul>
                </div>
                <!-- –ë—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã -->
                <div class="quick-tags mt-3" style="width: 100%;">
                    <div class="d-flex align-items-center" style="gap: 0.5rem; flex-wrap: wrap; width: 100%;">
                        <button class="btn btn-primary flex-grow-1" onclick="quickSearch('–≠–∫–æ–ª–æ–≥–∏—è')">üåç –≠–∫–æ–ª–æ–≥–∏—è
                        </button>
                        <button class="btn btn-primary flex-grow-1" onclick="quickSearch('–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ')">üéì –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
                        </button>
                        <button class="btn btn-primary flex-grow-1" onclick="quickSearch('–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç')">üöá –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç
                        </button>
                        <button class="btn btn-primary flex-grow-1" onclick="quickSearch('–ú–µ–¥–∏—Ü–∏–Ω–∞')">üè• –ú–µ–¥–∏—Ü–∏–Ω–∞
                        </button>

                        <div class="dropdown">
                            <button class="btn btn-primary dropdown-toggle d-flex align-items-center"
                                    type="button" id="moreFiltersBtn" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-chat-square-dots me-1"></i> –î—Ä—É–≥–∏–µ
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="moreFiltersBtn">
                                <li><a class="dropdown-item" href="#" onclick="quickSearch('–ü—Ä–∞–≤–∞ —á–µ–ª–æ–≤–µ–∫–∞')">‚úä –ü—Ä–∞–≤–∞
                                        —á–µ–ª–æ–≤–µ–∫–∞</a></li>
                                <li><a class="dropdown-item" href="#" onclick="quickSearch('–≠–∫–æ–Ω–æ–º–∏–∫–∞')">üí∞ –≠–∫–æ–Ω–æ–º–∏–∫–∞</a>
                                </li>
                                <li><a class="dropdown-item" href="#" onclick="quickSearch('–ö—É–ª—å—Ç—É—Ä–∞')">üé≠ –ö—É–ª—å—Ç—É—Ä–∞</a>
                                </li>
                                <li><a class="dropdown-item" href="#" onclick="quickSearch('–°–ø–æ—Ä—Ç')">üèÖ –°–ø–æ—Ä—Ç</a></li>
                                <li><a class="dropdown-item" href="#" onclick="quickSearch('–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏')">üíª
                                        –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
        <div id="resultsContainer" class="row gy-4">
            <#if petitions?has_content>
                <#list petitions as petition>
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title petition-title">
                                    <a href="/specific-petition/${petition.id}">${petition.title}</a>
                                </h5>
                                <p class="card-text text-muted description-truncate">
                                    ${petition.description}</p>
                                <span>
                                    <i class="bi bi-person-circle text-danger"></i>
                                    <span class="text-muted">${petition.authorUsername}</span>
                                </span>
                                <div class="d-flex justify-content-between text-muted small">
                                    <span>
                                        <i class="bi bi-people text-success"></i>
                                        <#assign count = petition.countOfSignatures>
                                        <#assign lastDigit = count % 10>
                                        <#assign lastTwoDigits = count % 100>

                                        <#if lastTwoDigits gte 11 && lastTwoDigits lte 14>
                                            ${count} –ø–æ–¥–ø–∏—Å–µ–π
                                        <#elseif lastDigit == 1>
                                            ${count} –ø–æ–¥–ø–∏—Å—å
                                        <#elseif lastDigit gte 2 && lastDigit lte 4>
                                            ${count} –ø–æ–¥–ø–∏—Å–∏
                                        <#else>
                                            ${count} –ø–æ–¥–ø–∏—Å–µ–π
                                        </#if>
                                    </span>
                                    <span><i class="bi bi-calendar-event me-1 text-primary"></i>${petition.formattedDateOfCreation}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </#list>
            <#else>
                <div class="col-12">
                    <div class="alert alert-info">
                        <#if query?has_content>
                            –ü–æ –∑–∞–ø—Ä–æ—Å—É "${query}" –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.
                        <#else>
                            –í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
                        </#if>
                    </div>
                </div>
            </#if>
        </div>
    </div>

    <script src="/js/petitions/search-searching-script.js"></script>

</@layout.main>